<h1 id="nciso">ncISO</h1>
<p>ncISO is a package of tools that facilitates the generation of <a href="/ISO_19115_Geographic_Information_%E2%80%93_Metadata" title="wikilink">ISO 19115-2</a> metadata from <a href="http://www.unidata.ucar.edu/software/netcdf/">NetCDF</a> data sources stored in a <a href="http://www.unidata.ucar.edu/projects/THREDDS/">THREDDS</a> data server (TDS) catalog. There are currently two tools available, first a command line utility that can be run on your local desktop or workstation, and second a THREDDS server extension library. See <a href="http://www.ngdc.noaa.gov/thredds/sstCatalog.html?dataset=SST-Aerosol-Agg">this</a> and other data pages on the <a href="http://www.ngdc.noaa.gov/thredds/catalog.html">NGDC THREDDS Server</a> for examples of the ncISO extension to THREDDS.</p>
<h2 id="latest-release-notes">Latest Release Notes</h2>
<p>The latest release for desktop ncISO is version 2.0. It includes a number of enhancements and bug fixes which include:</p>
<ol style="list-style-type: decimal">
<li><p>A move from XALAN and XSL 1.0 to SAXON and XSL 2.0. This has simplified the login surrounding <a href="https://geo-ide.noaa.gov/wiki/index.php?title=NetCDF_Attribute_Convention_for_Dataset_Discovery#Determining_an_Order_of_Precedence">precedence</a> issues.</p></li>
<li><p>New transfer options for OpenDAP viewers like NCDC’s climate and weather toolkit. These new <gmd:MD_DigitalTransferOptions> allow linkages to be created in applications like geoportal.</p></li>
<li><p>Improved resolution calculations for geospatial and temporal extents.</p></li>
<li><p>Improved dimension counts.</p></li>
<li><p>Enhanced crawling capabilities based on an ISO series record.</p></li>
</ol>
<h2 id="server-extension-to-thredds">Server Extension to THREDDS</h2>
<p>Source code: <a href="https://github.com/Unidata/threddsIso" class="uri">https://github.com/Unidata/threddsIso</a></p>
<h2 id="command-line-utility">Command Line Utility</h2>
<p><a href="/Image:Commandline.png" title="wikilink">thumbThe</a> command line utility traverses a THREDDS catalog and creates a local directory structure containing <a href="http://www.unidata.ucar.edu/software/netcdf/ncml/">NCML</a>, a metadata rubric, and ISO metadata. NCML is a markup language for NetCDF files and is the most common way in which NetCDF files are documented. This utility evaluates a dataset’s NCML based on its conformance to <a href="http://www.unidata.ucar.edu/software/netcdf-java/formats/DataDiscoveryAttConvention.html">Unidata Data Discovery Conventions</a>, and using an Extensible Stylesheet Language Transformation (XSLT), a graphical report (rubric) of existing documentation is made. Users can improve the quality of their metadata by using the rubric and following a <a href="/Creating_Good_Documentation" title="wikilink">spiral</a> process for enhancing dataset documentation. As the documentation is improved users will see an improvement in their rubric scores as well as in the quality of their ISO metadata. All of the metadata outputs from the command line utility are available as an html report (see image at right).</p>
<h2 id="thredds-server-extension">THREDDS Server Extension</h2>
<p><a href="/Image:Threddsiso.png" title="wikilink">thumbThe</a> THREDDS server extension library integrates these metadata tools directly into THREDDS as services. Using the same XSLTs as the command line utility and leveraging THREDDS service oriented architecture, three new services are made available namely an NCML service, a metadata rubric service called UDDC, and an ISO service. At right is an an image depicting the services available after the server extension library has been installed.</p>
<h2 id="instructions-and-downloads">Instructions and Downloads</h2>
<p>Download a zip of the jar file here: <a href="https://geo-ide.noaa.gov/wiki/images/9/90/NcISO-2.3.zip" class="uri">https://geo-ide.noaa.gov/wiki/images/9/90/NcISO-2.3.zip</a></p>
<p>Source code for the client application: <a href="https://github.com/NOAA-PMEL/uafnciso" class="uri">https://github.com/NOAA-PMEL/uafnciso</a></p>
<p>ncISO: A command-line utility for automating metadata analysis and ISO metadata generation for THREDDS Catalogs</p>
<p>DESCRIPTION</p>
<p>The ncISO Tool traverses THREDDS Catalogs, reads dataset documentation and translates that documentation into different views using Extensible Stylesheet Language Transformations (XSLT). Two stylesheets are currently supported: A graphical comparison (rubric) of existing documentation with the Unidata Data Discovery Conventions with guidance on using those conventions to facilitate data discovery; and Translation of discovery elements from NcML into ISO 19115. INSTRUCTIONS Download ncISO Version 2.3 Extract the jar into a local directory. Open a shell window or command prompt from the directory that contains the extracted files. Enter the command java –jar ncISO.jar to see available ncISO arguments and descriptions of how to use them. Enter the ncISO command with appropriate arguments. Prior versions of ncISO are available.</p>
<p>OPTIONS</p>
<p>–Xms1024m and –Xmx1024m: Standard java elements for specifying the amount of memory to allocate to the ncISO utility. In this case 1024 megaBytes are specified for initial and maximum memory.</p>
<p>–ts THREDDS_CATALOG_URL: specifies the URL of the THREDDS catalog to process.</p>
<p>–num N: specifies the number of datasets to process per branch. Specifying a small number of datasets/branch, as in this case, results in a fast sample scan that is representative in THREDDS catalogs with generally homogeneous content in each branch. Specify a large number for a translation of all content.</p>
<p>–depth 20: limits the crawlers descent into the catalog.</p>
<p>–iso: signals to the crawler to generate ISO.</p>
<p>–waf ROOT_WAF_FOLDER: signals the crawler to dump files to a flat WAF structure.</p>
<p>–custom: signals to the crawler to translate the NCML using a custom stylesheet.</p>
<p>–xslt: XSLT_FILENAME located in an xslt subfolder.</p>
<p>EXAMPLES</p>
<p>Crawl NOAA’s NGDC THREDDS catalog and generate metadata: java -Xms1024m -Xmx1024m -jar ncISO-2.2.2.jar -ts <a href="http://www.ngdc.noaa.gov/thredds/catalog.xml" class="uri">http://www.ngdc.noaa.gov/thredds/catalog.xml</a> -num 1 -depth 20 -iso true</p>
<p>After the utility has completed running, a thredds directory will be created storing NCML, a metadata report and ISO xml for each NetCDF dataset that was located. In addition a thredds.json file is generated that allows a tree based display in your browser. In order to view these results in the browser copy the nciso.html, thredds.json and directory structure into a web accessible location. Now open nciso.html to visualize and access the results in your browser, for example: <a href="http://localhost/yourpath/nciso.html" class="uri">http://localhost/yourpath/nciso.html</a>.</p>
<h2 id="questions-and-answers">Questions and Answers</h2>
<p>Many ncISO users come up with great questions about the way that attributes are being translated from CF/netCDF/THREDDDS to ISO. Many times multiple users have the same question.</p>
<h3 id="translation-vs.-conversion">Translation vs. Conversion</h3>
<p>There is a blurry line between the processes of translation and conversion. Translation involves restructuring but not changing content. Conversion implies restructuring and changing the content. There are several places in ncISO where translation/conversion questions come up. Perhaps the most clear example is the contributor_role attribute. This is a character string that contains an uncontrolled value for the role that a person or organization played in relation to the dataset. Semantically this attribute is clearly equivalent to the gmd:CI_ResponsibleParty/gmd:role/gmd:CI_RoleCode in ISO. The ISO role, however, is controlled by a <a href="/ISO_19115_and_19115-2_CodeList_Dictionaries#CI_RoleCode:" title="wikilink">codelist</a>. In cases like this, ncISO plays a translation role rather than a conversion role. The value in the contributor_role attribute is copied into the gmd:CI_RoleCode without validating that it is actually in the appropriate codelist. Creating a general crosswalk between the code list and all possible contributor_roles is beyond the scope of ncISO.</p>
<h3 id="nciso-units---udunits-or-ucum">ncISO units - UDUnits or UCUM?</h3>
<p>There are a number of places in scientific data files where units are required and there are many sources for information about and standard unit definitions/conversions. The convention in netCDF is to use the <a href="http://www.unidata.ucar.edu/software/udunits/">Unidata UDUNITS Tools</a>. In order to reference these units from an ISO file we need a URI (or a persistent URL) that might look like: <gmd:units xlink:href="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/uom/gmxUom.xml#deg"/> which is a reference to the unit degree in the sample ISO units catalog. UDUNITS does not currently provide such a resource although there is some <a href="http://www.unidata.ucar.edu//software/udunits/udunits-2-units.html">XML</a> available.</p>
<p>The <a href="/http://unitsofmeasure.org/_Unified_Code_for_Units_of_Measure" title="wikilink">&lt;http://unitsofmeasure.org/&gt; Unified Code for Units of Measure</a> provides a possible alternative to UDUNITS that is broader in scope. The <a href="/http://marinemetadata.org/references/ucumunits_Marine_Metadata_Interoperability_Project" title="wikilink">&lt;http://marinemetadata.org/references/ucumunits&gt; Marine Metadata Interoperability Project</a> has some discussion of this catalog. There is an <a href="/http://aurora.regenstrief.org/~ucum/ucum-essence.xml_XML" title="wikilink">&lt;http://aurora.regenstrief.org/~ucum/ucum-essence.xml&gt; XML</a> representation of UCUM, but it is not a catalog with elements that can be referenced.</p>
<p><a href="/http://coastwatch.pfeg.noaa.gov/erddap/convert/units.html_ERDDAP" title="wikilink">&lt;http://coastwatch.pfeg.noaa.gov/erddap/convert/units.html&gt; ERDDAP</a> provides a service for translating between UDUNITS and UCUM.</p>
<h3 id="keyword-delimiters-and-vocabularies">Keyword Delimiters and Vocabularies</h3>
<p>The <a href="http://www.unidata.ucar.edu/software/netcdf-java/formats/DataDiscoveryAttConvention.html">ACDD</a> definition of the keywords attribute specifies that it is a comma-delimited list. Early versions of ncISO were treating this as a space-delimited list. This was corrected in Version 2.21. If the keyword list includes commas or the string ‘&gt;’ the translation assumes that it is a comma separated list. If not, it assumes that the list is space-delimited.</p>
<p>There is currently no attempt made to estimate the keyword vocabulary from the form of the keywords, e.g if the keywords contain ‘-’ they are CF parameter names, if they contain &gt; they are GCMD keywords.</p>
<h3 id="xml-ids">XML ids</h3>
<p>There are some elements in the ISO metadata, primarily gml:TimePeriod, that <em>require</em> an id attribute. These attributes need to be unique in the output file. The most straightforward mechanism for creating these is to use the xsl:generate-id() function that generates an id that depends on the position in the source file. This approach leads to ids that look like: <gml:TimePeriod gml:id="d1e108"> and are unique in the output file unless the same input element is used more than once.</p>
<h3 id="dimension-information">Dimension Information</h3>
<p>Information about dimensions can be spread all over a netCDF file. The names and lengths are defined in dimension tags (<dimension name="lat" length="1"/>), the units are defined in variables with the same name as the dimension (<attribute name="units" value="degrees_north"/>), and the minima and maxima can be inferred from the data using CF, or they can be in the THREDDS catalog, or they can be in global attributes. Pulling this information together in XSLT (the translation tool used in ncISO) can be a challenge. Treatment of dimensions was improved significantly in NcISO 2.0 by adding the capability to identify dimension variables. This was done using the following XSLT:</p>
<pre><code>  &lt;xsl:variable name=&quot;longitudeVariableName&quot; select=&quot;//nc:variable[nc:attribute[@name=&#39;units&#39; and @value=&#39;degrees_east&#39;]]/@name&quot;/&gt;
  &lt;xsl:variable name=&quot;latitudeVariableName&quot; select=&quot;//nc:variable[nc:attribute[@name=&#39;units&#39; and @value=&#39;degrees_north&#39;]]/@name&quot;/&gt;
  &lt;xsl:variable name=&quot;verticalVariableName&quot; select=&quot;//nc:variable[nc:attribute[@name=&#39;positive&#39; and (@value=&#39;up&#39; or @value=&#39;down&#39;)]]/@name&quot;/&gt;
  &lt;xsl:variable name=&quot;timeVariableName&quot; select=&quot;//nc:variable[nc:attribute[@name=&#39;standard_name&#39; and lower-case(@value)=&#39;time&#39;]]/@name&quot;/&gt;</code></pre>
<ul>
<li>The longitude/latitude variables have an attribute named units and a value of degrees_east/degrees_north.</li>
<li>The vertical variable has an attribute named positive with a value of up or down and</li>
<li>The temporal variable has an attribute named standard_name and a value of time.</li>
</ul>
<p>If funny things are happening with dimensions in you ISO XML it is likely to be related to incorrectly identifying these variables!</p>
<p><a href="/Category:Metadata_Tools" title="wikilink">Category:Metadata Tools</a></p>
